rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Default: deny all access
    match /{document=**} {
      allow read, write: if false;
    }

    // Allow reading and writing permission documents
    // Path: tenant/{tenantId}/module/{moduleId}/role/{roleId}
    match /tenant/{tenantId}/module/{moduleId}/role/{roleId} {
      // DEVELOPMENT/TESTING: Allow all (NOT SECURE)
      allow read, write: if true;
      
      // PRODUCTION: Uncomment below and remove above
      // allow read, write: if request.auth != null;
    }

    // Allow recursive access to all sub-paths under tenant
    match /tenant/{tenantId}/{document=**} {
      allow read, write: if true;  // Development only
      // For production: allow read, write: if request.auth != null;
    }
  }
}

